<moar-munz-lobby *ngIf="!match"></moar-munz-lobby>
<div *ngIf="match" class="game-wrapper">
    <div class="board">
        <div class="board-center">
            <mat-card class="info-column">
                <p>Last roll:</p>
                <div class="dice">
                    <div>{{match?.lastDice[0]}}</div>
                    <div>{{match?.lastDice[1]}}</div>
                    <button mat-flat-button color="primary" [style.visibility]="playerService.isMyTurn ? 'visible' : 'hidden'" (click)="throwDice()">Play!</button>
                </div>
                <mat-accordion class="player-list" multi>
                    <mat-expansion-panel *ngFor="let card of playerCards; let i = index"
                    class="player-card"
                    [style.border-left]="playerService.playerTurn === card.player.id ? '5px solid '+card.player.color : 'none'"
                    [style.background-color]="isPlayerHighlighted(card.player.id) ? (card.player.color | lighten: 0.8) : ''"
                    (mouseenter)="highlightCardProperties(card.properties, true)"
                    (mouseleave)="highlightCardProperties(card.properties, false)">
                        <mat-expansion-panel-header>
                        <mat-panel-title>
                            <span [style.fontWeight]="card.player.id == uuid ? 'bold' : 'normal'"
                            [style.color]="card.player.color">{{card.player.name}}</span>
                        </mat-panel-title>
                        <mat-panel-description>
                            <span><strong>Æµ {{card.player.money}}</strong></span>
                            <mat-icon [style.visibility]="card.player.id === uuid ? 'hidden' : 'visible'"
                            (click)="openPlayerChat(card.player, $event)"
                            [matBadge]="chatComponent.getUnreadMessages(card.player.id) || undefined"
                            matBadgeColor="warn" matBadgeSize="small">message</mat-icon>
                        </mat-panel-description>
                        </mat-expansion-panel-header>
                        <div class="player-properties">
                            <span *ngFor="let property of card.properties"
                            style="font-size: smaller;">{{property.name}}</span>
                        </div>
                    </mat-expansion-panel>
                </mat-accordion>
            </mat-card>
            <mat-card *ngIf="activeTrade" class="trade-info"></mat-card>
            <div class="board-input-wrapper">
                <mat-card *ngIf="notificationData" class="board-input">
                    <mat-card-title>
                        <pre>{{notificationData.message}}</pre>
                    </mat-card-title>
                    <mat-action-list>
                        <mat-divider></mat-divider>
                        <button mat-list-item *ngFor="let option of notificationData?.options; last as last"
                        (click)="onQuestionAnswer(option)"
                        (mouseenter)="highlightOption(option, true)"
                        (mouseleave)="highlightOption(option, false)">
                            <span>{{option}}</span>
                            <mat-divider *ngIf="!last"></mat-divider>
                        </button>
                        <button mat-list-item *ngIf="!notificationData.options"
                        (click)="notificationData = undefined">
                            <span>OK</span>
                        </button>
                    </mat-action-list>
                </mat-card>
            </div>
            <mat-card class="board-chat">
                <moar-munz-chat [match]="match"></moar-munz-chat>
            </mat-card>
        </div>
        <moar-munz-tile *ngFor="let tile of tiles; let i = index"
            [index]="i" [highlighted]="isTileHighlighted(i)"
            class="tile"
            [style.gridColumnStart]="tile.x + 1"
            [style.gridRowStart]="tile.y + 1"
            [style.border]="'1px solid black'"
            (click)="onTileClicked(i)"
            (mouseenter)="highlightTile(i, true)"
            (mouseleave)="highlightTile(i, false)">
        </moar-munz-tile>
    </div>
</div>
