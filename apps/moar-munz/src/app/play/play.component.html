<div *ngIf="!match" class="lobby-wrapper">
    <mat-card class="player-wrapper">
        <mat-card-title>Lobby</mat-card-title>
        <mat-divider></mat-divider>
        <mat-list class="player-list">
            <mat-list-item *ngFor="let id of lobby?.playerOrder; last as last"
            class="player-list-item"
            [style.backgroundColor]="id === uuid ? 'none' : '#eee'">
                <div *ngIf="lobby.players[id]" class="player-item">
                    <span [style.color]="lobby.players[id].color">{{lobby.players[id].name}}</span>

                    <mat-icon *ngIf="!lobby.players[id].ready" [style.color]="lobby.players[id].color">hourglass_empty</mat-icon>
                    <mat-icon *ngIf="lobby.players[id].ready" [style.color]="lobby.players[id].color">check_circle</mat-icon>

                </div>
                <div *ngIf="first && lobby.players[id]?.ai"
                    class="player-list-button-hoverable"
                    (click)="onLobbyPlayerClick(lobby.players[id])">
                    <span>Remove A.I.</span>
                </div>
                <mat-divider *ngIf="!last || (first && lobby?.options.ai)"></mat-divider>
            </mat-list-item>
            <mat-list-item *ngIf="first && lobby?.options.ai"
            class="player-list-item">
                <div class="player-list-button"
                    (click)="onLobbyAddAI()">
                    <span>Add A.I.</span>
                </div>
            </mat-list-item>
        </mat-list>
    </mat-card>
    <button *ngIf="player?.ready" class="ready-button" mat-flat-button color="warn" (click)="onReady(false)">Not ready!</button>
    <button *ngIf="!player?.ready" class="ready-button" mat-flat-button color="primary" (click)="onReady(true)">I'm ready!</button>
</div>
<div *ngIf="match" class="game-wrapper">
    <div class="board">
        <div class="board-center">
            <mat-card class="info-column">
                <p>Last roll:</p>
                <div class="dice">
                    <div>{{match?.lastDice[0]}}</div>
                    <div>{{match?.lastDice[1]}}</div>
                    <button mat-flat-button color="primary" [style.visibility]="isMyTurn ? 'visible' : 'hidden'" (click)="throwDice()">Play!</button>
                </div>

<!-- <mat-accordion>
    <mat-expansion-panel hideToggle>
      <mat-expansion-panel-header>
        <mat-panel-title>
          This is the expansion title
        </mat-panel-title>
        <mat-panel-description>
          This is a summary of the content
        </mat-panel-description>
      </mat-expansion-panel-header>
      <p>This is the primary content of the panel.</p>
    </mat-expansion-panel>
    <mat-expansion-panel (opened)="panelOpenState = true"
                         (closed)="panelOpenState = false">
      <mat-expansion-panel-header>
        <mat-panel-title>
          Self aware panel
        </mat-panel-title>
        <mat-panel-description>
          Currently I am {{panelOpenState ? 'open' : 'closed'}}
        </mat-panel-description>
      </mat-expansion-panel-header>
      <p>I'm visible because I am open</p>
    </mat-expansion-panel>
  </mat-accordion> -->
                <mat-accordion class="player-list" multi>
                    <mat-expansion-panel *ngFor="let card of playerCards; let i = index"
                    class="player-card"
                    [style.border-left]="playerTurn === card.player.id ? '5px solid '+card.player.color : 'none'"
                    [style.box-shadow]="card.player.highlighted ? '0 0 10px 0 ' + card.player.color : ''"
                    (mouseenter)="onPlayerMouseEnter(card.player)"
                    (mouseleave)="onPlayerMouseLeave(card.player)"
                    (click)="openPlayerChat(card.player)">
                        <mat-expansion-panel-header>
                        <mat-panel-title>
                            <span [style.fontWeight]="card.player.id == uuid ? 'bold' : 'normal'"
                            [style.color]="card.player.color">{{card.player.name.padEnd(30, ' ')}}</span>
                        </mat-panel-title>
                        <mat-panel-description>
                            <span><strong>Æµ {{card.player.money}}</strong></span>
                        </mat-panel-description>
                        </mat-expansion-panel-header>
                        <div class="player-properties">
                            <span *ngFor="let property of getPlayerProperties(card.player)"
                            style="font-size: smaller;">{{property.name}}</span>
                        </div>
                    </mat-expansion-panel>
                </mat-accordion>
            </mat-card>
            <mat-card *ngIf="activeTrade" class="trade-info"></mat-card>
            <div class="board-input-wrapper">
                <mat-card *ngIf="notificationData" class="board-input">
                    <mat-card-title>
                        <pre>{{notificationData.message}}</pre>
                    </mat-card-title>
                    <mat-action-list>
                        <mat-divider></mat-divider>
                        <button mat-list-item *ngFor="let option of notificationData?.options; last as last"
                        (click)="onQuestionAnswer(option)"
                        (mouseenter)="onOptionMouseEnter(option)"
                        (mouseleave)="onOptionMouseLeave(option)">
                            <span>{{option}}</span>
                            <mat-divider *ngIf="!last"></mat-divider>
                        </button>
                        <button mat-list-item *ngIf="!notificationData.options"
                        (click)="notificationData = undefined">
                            <span>OK</span>
                        </button>
                    </mat-action-list>
                </mat-card>
            </div>
            <mat-card class="board-chat">
                <moar-munz-chat
                [lobby]="lobby"
                [match]="match">
                </moar-munz-chat>
            </mat-card>
        </div>
        <moar-munz-tile *ngFor="let tileData of tileDisplayOrder"
        [match]="match" [lobby]="lobby" [tile]="tileData.tile"
        [index]="tileData.i" [players]="players"
        class="tile"
        [style.border]="'1px solid black'"
        (click)="onTileClicked(tileData.tile)"
        (mouseenter)="onTileMouseEnter(tileData.tile)"
        (mouseleave)="onTileMouseLeave(tileData.tile)">
        </moar-munz-tile>
    </div>
</div>
