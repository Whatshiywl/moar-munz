<moar-munz-lobby *ngIf="!match"></moar-munz-lobby>
<div *ngIf="match" class="game-wrapper">
    <div class="board">
        <div class="board-center">
            <mat-card class="info-column">
                <p>Last roll:</p>
                <div class="dice">
                    <div>{{match?.lastDice[0]}}</div>
                    <div>{{match?.lastDice[1]}}</div>
                    <button mat-flat-button color="primary" [style.visibility]="playerService.isMyTurn ? 'visible' : 'hidden'" (click)="throwDice()">Play!</button>
                </div>
                <mat-accordion class="player-list" multi>
                    <mat-expansion-panel *ngFor="let card of playerCards; let i = index"
                    class="player-card"
                    [style.border-left]="playerService.playerTurn === card.player.id ? '5px solid '+card.player.color : 'none'"
                    [style.background-color]="isPlayerHighlighted(card.player.id) ? (card.player.color | lighten: 0.8) : ''"
                    (mouseenter)="highlightCardProperties(card.properties, true)"
                    (mouseleave)="highlightCardProperties(card.properties, false)">
                        <mat-expansion-panel-header>
                        <mat-panel-title>
                            <span [style.fontWeight]="card.player.id == uuid ? 'bold' : 'normal'"
                            [style.color]="card.player.color">{{card.player.name}}</span>
                        </mat-panel-title>
                        <mat-panel-description>
                            <span><strong>Æµ {{card.player.money}}</strong></span>
                            <mat-icon [style.visibility]="card.player.id === uuid ? 'hidden' : 'visible'"
                            (click)="openPlayerChat(card.player, $event)"
                            [matBadge]="chatComponent.getUnreadMessages(card.player.id) || undefined"
                            matBadgeColor="warn" matBadgeSize="small">message</mat-icon>
                        </mat-panel-description>
                        </mat-expansion-panel-header>
                        <div class="player-properties">
                            <span *ngFor="let property of card.properties"
                            style="font-size: smaller;">{{property.name}}</span>
                        </div>
                    </mat-expansion-panel>
                </mat-accordion>
            </mat-card>
            <moar-munz-prompt *ngIf="promptService.awaitingResponse"
                [debug]="debug"
                [style.gridRowEnd]="'span ' + (activeTrade ? '1' : '2')"
                (optionmouseenter)="highlightOption($event, true)"
                (optionmouseleave)="highlightOption($event, false)"
            ></moar-munz-prompt>
            <mat-card *ngIf="activeTrade" class="trade-info"></mat-card>
            <mat-card class="board-chat">
                <moar-munz-chat></moar-munz-chat>
            </mat-card>
        </div>
        <moar-munz-tile *ngFor="let tile of tiles; let i = index"
            [index]="i" [highlighted]="isTileHighlighted(i)"
            class="tile"
            [style.gridColumnStart]="tile.x + 1"
            [style.gridRowStart]="tile.y + 1"
            [style.border]="'1px solid black'"
            (click)="onTileClicked(i)"
            (mouseenter)="highlightTile(i, true)"
            (mouseleave)="highlightTile(i, false)">
        </moar-munz-tile>
    </div>
</div>
